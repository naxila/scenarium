<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scenarium - Scenarium - Telegram Bot Constructor Documentation</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Sidebar Menu -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h1><a href="index.html" style="text-decoration: none; color: inherit;">🤖 Scenarium</a></h1>
                <p class="version"><a href="https://github.com/naxila/scenarium" target="_blank" style="text-decoration: none; color: inherit;">v0.1.0-alpha</a></p>
            </div>
            
            <div class="sidebar-content">
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="#overview" class="nav-link active">📋 Overview</a>
                    </li>
                    <li class="nav-item">
                        <a href="#installation" class="nav-link">📦 Installation</a>
                    </li>
                    <li class="nav-item">
                        <a href="#quick-start" class="nav-link">🚀 Quick Start</a>
                    </li>
                    <li class="nav-item">
                        <a href="#scenarios" class="nav-link">📝 Scenarios</a>
                    </li>
                    <li class="nav-item">
                        <a href="#custom-actions" class="nav-link">⚡ Custom Actions</a>
                    </li>
                    <li class="nav-item">
                        <a href="#custom-functions" class="nav-link">🔧 Custom Functions</a>
                    </li>
                    <li class="nav-item">
                        <a href="#interpolation" class="nav-link">🔗 Interpolation</a>
                    </li>
                    <li class="nav-item">
                        <a href="#examples" class="nav-link">💡 Examples</a>
                    </li>
                    <li class="nav-item">
                        <a href="#actions" class="nav-link">⚡ Built-in Actions</a>
                        <ul class="submenu">
                            <li><a href="actions/send-message.html" class="nav-link">SendMessage</a></li>
                            <li><a href="actions/navigate.html" class="nav-link">Navigate</a></li>
                            <li><a href="actions/back.html" class="nav-link">Back</a></li>
                            <li><a href="actions/request-input.html" class="nav-link">RequestInput</a></li>
                            <li><a href="actions/cancel-awaiting-input.html" class="nav-link">CancelAwaitingInput</a></li>
                            <li><a href="actions/update-message.html" class="nav-link">UpdateMessage</a></li>
                            <li><a href="actions/delete-message.html" class="nav-link">DeleteMessage</a></li>
                            <li><a href="actions/store.html" class="nav-link">Store</a></li>
                            <li><a href="actions/request-api.html" class="nav-link">RequestApi</a></li>
                            <li><a href="actions/custom.html" class="nav-link">CustomAction</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a href="#functions" class="nav-link">🔧 Built-in Functions</a>
                        <ul class="submenu">
                            <li><a href="functions/join-to-string.html" class="nav-link">JoinToString</a></li>
                            <li><a href="functions/equals.html" class="nav-link">Equals</a></li>
                            <li><a href="functions/read-storage.html" class="nav-link">ReadStorage</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <div class="content">
                <!-- Overview -->
                <section id="overview" class="section">
                    <h1>🤖 Scenarium</h1>
                    <p class="lead">TypeScript library for creating Telegram bots from JSON scenarios with support for extensible actions and functions.</p>
                    
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">📝</div>
                            <h3>JSON Scenarios</h3>
                            <p>Create bots without programming using simple JSON configurations</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">⚡</div>
                            <h3>Extensible Actions</h3>
                            <p>Rich set of built-in actions and ability to create custom ones</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🔧</div>
                            <h3>Custom Functions</h3>
                            <p>Create complex logic using built-in and custom functions</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🌐</div>
                            <h3>API Integration</h3>
                            <p>Easy integration with external APIs and services</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">💾</div>
                            <h3>Local Storage</h3>
                            <p>Save and manage user data</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🔗</div>
                            <h3>Interpolation</h3>
                            <p>Dynamic variable substitution in texts and parameters</p>
                        </div>
                    </div>

                    <h2>🎯 Key Features</h2>
                    <ul class="feature-list">
                        <li><strong>Modular Architecture</strong> - break down complex bots into logical modules</li>
                        <li><strong>Navigation System</strong> - full navigation with back stack support</li>
                        <li><strong>Input Handling</strong> - request and validate user input</li>
                        <li><strong>Message Management</strong> - send, update and delete messages</li>
                        <li><strong>Multi-user Support</strong> - isolated sessions for each user</li>
                        <li><strong>TypeScript</strong> - full type safety for reliable development</li>
                        <li><strong>Custom Actions & Functions</strong> - extend functionality with custom code</li>
                        <li><strong>NPM Package</strong> - easy installation and integration</li>
                    </ul>
                </section>

                <!-- Installation -->
                <section id="installation" class="section">
                    <h2>📦 Installation</h2>
                    <p>Install Scenarium using npm:</p>
                    
                    <div class="code-block">
                        <h3>NPM</h3>
                        <pre><code class="language-bash">npm install scenarium</code></pre>
                    </div>

                    <div class="code-block">
                        <h3>Yarn</h3>
                        <pre><code class="language-bash">yarn add scenarium</code></pre>
                    </div>

                    <div class="code-block">
                        <h3>PNPM</h3>
                        <pre><code class="language-bash">pnpm add scenarium</code></pre>
                    </div>

                    <h3>Requirements</h3>
                    <ul>
                        <li>Node.js >= 16.0.0</li>
                        <li>TypeScript >= 5.0.0 (for TypeScript projects)</li>
                    </ul>
                </section>

                <!-- Quick Start -->
                <section id="quick-start" class="section">
                    <h2>🚀 Quick Start</h2>
                    <p>Get started with Scenarium in just a few steps:</p>

                    <h3>1. Create a Bot</h3>
                    <p>First, create a bot using <a href="https://t.me/BotFather" target="_blank">@BotFather</a> and get your bot token.</p>

                    <h3>2. Install Dependencies</h3>
                    <pre><code class="language-bash">npm install scenarium dotenv</code></pre>

                    <h3>3. Create a Simple Scenario</h3>
                    <p>Create a file called <code>scenario.json</code>:</p>
                    <pre><code class="language-json">{
  "onStartActions": [
    {
      "action": "Navigate",
      "menuItem": "Main"
    }
  ],
  "menuItems": {
    "Main": {
      "onNavigation": {
        "action": "SendMessage",
        "text": "Hello! Welcome to my bot!",
        "inlineActions": [
          {
            "title": "Help",
            "onClick": {
              "action": "SendMessage",
              "text": "This is a help message!"
            }
          }
        ]
      }
    }
  }
}</code></pre>

                    <h3>4. Create Your Bot Instance</h3>
                    <p>Create a file called <code>index.js</code>:</p>
                    <pre><code class="language-javascript">const { BotFactory } = require('scenarium');
require('dotenv').config();

async function startBot() {
  const bot = await BotFactory.createBotFromFile('./scenario.json', process.env.BOT_TOKEN);
  
  await bot.start();
  console.log('✅ Bot started!');
}

startBot().catch(console.error);</code></pre>

                    <h3>5. Set Environment Variables</h3>
                    <p>Create a <code>.env</code> file:</p>
                    <pre><code class="language-bash">BOT_TOKEN=your_bot_token_here</code></pre>

                    <h3>6. Run Your Bot</h3>
                    <pre><code class="language-bash">node index.js</code></pre>

                    <p>That's it! Your bot is now running. Send <code>/start</code> to your bot in Telegram to test it.</p>
                </section>

                <!-- Scenarios -->
                <section id="scenarios" class="section">
                    <h2>📝 Scenarios</h2>
                    
                    <h3>Scenario Structure</h3>
                    <p>A scenario is a JSON file describing bot behavior:</p>
                    <pre><code class="language-json">{
  "onStartActions": [...],     // Actions on startup (required)
  "menuItems": {...},          // Menu items (optional)
  "functions": {...},          // Custom functions (optional)
  "data": {...}               // Common data (optional)
}</code></pre>

                    <h3>Simple Scenario (single file)</h3>
                    <p>For simple bots, one JSON file is enough:</p>
                    <pre><code class="language-json">{
  "onStartActions": [
    {
      "action": "Navigate",
      "menuItem": "Main"
    }
  ],
  "menuItems": {
    "Main": {
      "onNavigation": {
        "action": "SendMessage",
        "text": "Welcome!",
        "inlineActions": [
          {
            "title": "Profile",
            "onClick": {
              "action": "Navigate",
              "menuItem": "Profile"
            }
          }
        ]
      }
    }
  }
}</code></pre>

                    <h3>Advanced Scenario (modular structure)</h3>
                    <p>For complex bots, use modular structure:</p>
                    <div class="file-structure">
                        <pre><code>scenarios/my-bot/
├── scenario.config.json    # Configuration
├── scenario.json          # Entry point
├── modules/               # Business modules
│   ├── user-management.json
│   ├── settings.json
│   └── api-integration.json
└── shared/               # Common data
    ├── constants.json
    └── messages.json</code></pre>
                    </div>

                    <h4>scenario.config.json</h4>
                    <pre><code class="language-json">{
  "entryPoint": "scenario.json",
  "structure": {
    "modules": "modules",
    "shared": "shared"
  }
}</code></pre>

                    <h4>Module Example (modules/user-management.json)</h4>
                    <pre><code class="language-json">{
  "menuItems": {
    "Profile": {
      "onNavigation": {
        "action": "SendMessage",
        "text": "👤 Your Profile",
        "inlineActions": [...]
      }
    }
  },
  "functions": {
    "FormatUserInfo": {
      "function": "JoinToString",
      "values": [...]
    }
  },
  "data": {
    "userFields": ["name", "email", "phone"],
    "requiredFields": ["name", "email"]
  }
}</code></pre>
                </section>

                <!-- Custom Actions -->
                <section id="custom-actions" class="section">
                    <h2>⚡ Custom Actions</h2>
                    <p>Create custom actions to extend Scenarium's functionality with your own business logic.</p>

                    <h3>Creating a Custom Action</h3>
                    <p>To create a custom action, implement the <code>ICustomAction</code> interface:</p>

                    <pre><code class="language-typescript">import { ICustomAction } from 'scenarium';

export class MyCustomAction implements ICustomAction {
  readonly actionType = 'MyCustomAction';

  async process(action: any, context: any): Promise<void> {
    // Your custom logic here
    // Access user data via interpolation: {{userId}}, {{name}}, etc.
    
    // Example: Send a custom message
    await context.telegramService.sendMessage(
      action.userId,
      `Custom action executed! Data: ${JSON.stringify(action.data)}`
    );
  }
}</code></pre>

                    <h3>Registering Custom Actions</h3>
                    <p>Register your custom actions before creating bot instances:</p>

                    <pre><code class="language-typescript">import { RegistryManager } from 'scenarium';
import { MyCustomAction } from './MyCustomAction';

// Initialize the registry
RegistryManager.initialize();

// Register your custom action
RegistryManager.registerAction('MyCustomAction', new MyCustomAction());

// Now you can use it in your scenarios
const bot = await BotFactory.createBotFromFile('./scenario.json', 'YOUR_BOT_TOKEN');</code></pre>

                    <h3>Using Custom Actions in Scenarios</h3>
                    <p>Once registered, you can use your custom actions in JSON scenarios:</p>

                    <pre><code class="language-json">{
  "menuItems": {
    "Main": {
      "onNavigation": {
        "action": "MyCustomAction",
        "data": {
          "message": "Hello from custom action!",
          "userId": "{{userId}}"
        }
      }
    }
  }
}</code></pre>

                    <h3>Advanced Custom Actions</h3>
                    <p>For more complex scenarios, you can access the full context and perform multiple operations:</p>

                    <pre><code class="language-typescript">export class AdvancedCustomAction implements ICustomAction {
  readonly actionType = 'AdvancedCustomAction';

  async process(action: any, context: any): Promise<void> {
    try {
      // Store data using interpolation
      await context.userSessionManager.setData(action.userId, 'lastAction', action.data);
      
      // Send message
      await context.telegramService.sendMessage(
        action.userId,
        `Advanced action executed for user ${action.userId}`
      );
      
      // Navigate to another menu
      await context.actionProcessor.processAction({
        action: 'Navigate',
        menuItem: action.nextMenu || 'Main'
      }, context);
      
    } catch (error) {
      console.error('Custom action error:', error);
      await context.telegramService.sendMessage(
        action.userId,
        'Sorry, something went wrong!'
      );
    }
  }
}</code></pre>
                </section>

                <!-- Functions -->
                <section id="functions" class="section">
                    <h2>🔧 Functions</h2>
                    <p>Scenarium supports two types of functions for data processing:</p>
                    
                    <div class="info-card">
                        <h3>📝 Function Types</h3>
                        <ul>
                            <li><strong>Custom Functions</strong> - written in code (TypeScript/JavaScript) and registered in FunctionRegistry</li>
                            <li><strong>User Functions</strong> - defined in JSON scenarios in the <code>functions</code> section</li>
                        </ul>
                    </div>

                    <h3>🔧 Custom Functions</h3>
                    <p>Create custom functions to extend Scenarium's data processing capabilities.</p>

                    <h3>Creating a Custom Function</h3>
                    <p>In Scenarium, there are two ways to create custom functions:</p>

                    <h4>Method 1: Through ICustomFunction interface</h4>
                    <pre><code class="language-typescript">import { ICustomFunction, ProcessingContext } from 'scenarium';
import { InterpolationContextBuilder, InterpolationSystem } from 'scenarium';

export class MyCustomFunction implements ICustomFunction {
  readonly functionName = 'MyCustomFunction';

  async execute(params: any, context: ProcessingContext): Promise<any> {
    // Create interpolation context for this function
    const interpolationContext = InterpolationContextBuilder.createContext(context, params);
    
    // Create local scope for function-specific variables
    interpolationContext.local.createScope();
    
    try {
      // Set function variables
      interpolationContext.local.setVariable('input', params.input);
      interpolationContext.local.setVariable('processedAt', new Date().toISOString());
      
      // Process input data
      const processedInput = InterpolationSystem.interpolate(params.input, interpolationContext);
      
      // Update local variables
      interpolationContext.local.setVariable('processedInput', processedInput);
      
      const result = {
        processedAt: interpolationContext.local.getVariable('processedAt'),
        input: processedInput,
        processed: `Processed: ${processedInput}`
      };
      
      return result;
      
    } finally {
      // Clean up local scope when function completes
      interpolationContext.local.clearScope();
    }
  }
}</code></pre>

                    <h4>Method 2: Through static execute method</h4>
                    <pre><code class="language-typescript">import { ProcessingContext } from 'scenarium';
import { InterpolationContextBuilder, InterpolationSystem } from 'scenarium';

export class MyCustomFunction {
  static async execute(params: any, context: ProcessingContext): Promise<any> {
    // Create interpolation context for this function
    const interpolationContext = InterpolationContextBuilder.createContext(context, params);
    
    // Create local scope for function-specific variables
    interpolationContext.local.createScope();
    
    try {
      // Set function variables
      interpolationContext.local.setVariable('input', params.input);
      interpolationContext.local.setVariable('processedAt', new Date().toISOString());
      
      // Process input data
      const processedInput = InterpolationSystem.interpolate(params.input, interpolationContext);
      
      // Update local variables
      interpolationContext.local.setVariable('processedInput', processedInput);
      
      const result = {
        processedAt: interpolationContext.local.getVariable('processedAt'),
        input: processedInput,
        processed: `Processed: ${processedInput}`
      };
      
      return result;
      
    } finally {
      // Clean up local scope when function completes
      interpolationContext.local.clearScope();
    }
  }
}</code></pre>

                    <h3>Registering Custom Functions</h3>
                    <p>Register your custom functions in FunctionRegistry:</p>

                    <h4>For functions with ICustomFunction interface:</h4>
                    <pre><code class="language-typescript">import { FunctionRegistry } from 'scenarium';
import { MyCustomFunction } from './MyCustomFunction';

// Register function instance
FunctionRegistry.registerFunction('MyCustomFunction', new MyCustomFunction());</code></pre>

                    <h4>For functions with static execute method:</h4>
                    <pre><code class="language-typescript">import { FunctionRegistry } from 'scenarium';
import { MyCustomFunction } from './MyCustomFunction';

// Register function class
FunctionRegistry.registerFunction('MyCustomFunction', MyCustomFunction);</code></pre>

                    <h4>Using in scenarios:</h4>
                    <pre><code class="language-typescript">// Now you can use it in your scenarios
const bot = await BotFactory.createBotFromFile('./scenario.json', 'YOUR_BOT_TOKEN');</code></pre>

                    <h4>Which method to choose?</h4>
                    <ul>
                        <li><strong>ICustomFunction</strong> - use for functions that need to be instances (e.g., MapFunction)</li>
                        <li><strong>Static execute</strong> - use for utility functions (e.g., EqualsFunction, JoinToStringFunction)</li>
                    </ul>

                    <h3>Using Custom Functions in Scenarios</h3>
                    <p>Use your custom functions in JSON scenarios for data processing:</p>

                    <pre><code class="language-json">{
  "menuItems": {
    "Main": {
      "onNavigation": {
        "action": "SendMessage",
        "text": {
          "function": "MyCustomFunction",
          "input": "{{name}}"
        }
      }
    }
  }
}</code></pre>

                    <h3>User Functions (JSON Scenarios)</h3>
                    <p>User functions are defined directly in JSON scenarios and allow creating reusable logic without writing code:</p>

                    <h4>Creating User Functions</h4>
                    <p>Define functions in the <code>functions</code> section of your scenario:</p>

                    <pre><code class="language-json">{
  "functions": {
    "FormatUserInfo": {
      "params": {
        "name": "",
        "email": ""
      },
      "result": "👤 Name: **{{name}}**\n📧 Email: **{{email}}**"
    },
    "GetUserGreeting": {
      "params": {
        "user": {}
      },
      "result": {
        "function": "JoinToString",
        "values": [
          "Hello, ",
          {
            "function": "FormatBold",
            "text": "{{user.firstName}}"
          },
          "! 👋"
        ],
        "separator": ""
      }
    }
  }
}</code></pre>

                    <h4>Using User Functions</h4>
                    <p>Use user functions in scenario actions:</p>

                    <pre><code class="language-json">{
  "menuItems": {
    "Profile": {
      "onNavigation": {
        "action": "SendMessage",
        "text": {
          "function": "FormatUserInfo",
          "name": "{{user.firstName}}",
          "email": "{{user.email}}"
        }
      }
    },
    "Greeting": {
      "onNavigation": {
        "action": "SendMessage",
        "text": {
          "function": "GetUserGreeting",
          "user": "{{user}}"
        }
      }
    }
  }
}</code></pre>

                    <h4>Function Chains</h4>
                    <p>User functions can call other functions (built-in or user-defined):</p>

                    <pre><code class="language-json">{
  "functions": {
    "ComplexFormatting": {
      "params": {
        "data": {}
      },
      "result": {
        "function": "JoinToString",
        "values": [
          "📊 **Report:**\n",
          {
            "function": "FormatBold",
            "text": "{{data.title}}"
          },
          "\n📅 Date: {{data.date}}\n",
          {
            "function": "FormatUserInfo",
            "name": "{{data.author}}",
            "email": "{{data.authorEmail}}"
          }
        ],
        "separator": ""
      }
    }
  }
}</code></pre>

                    <h4>Best Practices for User Functions</h4>
                    <ul>
                        <li><strong>Use descriptive names</strong> - function names should clearly reflect their purpose</li>
                        <li><strong>Define parameters</strong> - always specify parameters in the <code>params</code> section for clarity</li>
                        <li><strong>Use interpolation</strong> - apply <code>{{variable}}</code> to access data</li>
                        <li><strong>Create reusable functions</strong> - functions should be universal</li>
                        <li><strong>Combine with built-in functions</strong> - use JoinToString, FormatBold and others</li>
                    </ul>

                    <h3>Advanced Custom Functions</h3>
                    <p>Create complex data processing functions:</p>

                    <pre><code class="language-typescript">export class DataProcessorFunction implements ICustomFunction {
  readonly functionName = 'DataProcessor';

  async execute(params: any, context: any): Promise<any> {
    // Access user data via interpolation: {{name}}, {{email}}, etc.
    
    // Process data based on parameters
    switch (params.operation) {
      case 'formatUserInfo':
        return this.formatUserInfo(params.userData, params.format);
      case 'calculateAge':
        return this.calculateAge(params.birthDate);
      case 'validateEmail':
        return this.validateEmail(params.email);
      default:
        throw new Error(`Unknown operation: ${params.operation}`);
    }
  }

  private formatUserInfo(userData: any, format: string): string {
    switch (format) {
      case 'full':
        return `${userData.name} (${userData.email})`;
      case 'short':
        return userData.name;
      default:
        return JSON.stringify(userData);
    }
  }

  private calculateAge(birthDate: string): number {
    const today = new Date();
    const birth = new Date(birthDate);
    return today.getFullYear() - birth.getFullYear();
  }

  private validateEmail(email: string): boolean {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
  }
}</code></pre>

                    <h3>Function Chaining</h3>
                    <p>You can chain functions together for complex data processing:</p>

                    <pre><code class="language-json">{
  "action": "SendMessage",
  "text": {
    "function": "JoinToString",
    "values": [
      "User: ",
      {
        "function": "DataProcessor",
        "operation": "formatUserInfo",
        "format": "full"
      },
      " | Age: ",
      {
        "function": "DataProcessor",
        "operation": "calculateAge"
      }
    ]
  }
}</code></pre>
                </section>

                <!-- Built-in Actions -->
                <section id="actions" class="section">
                    <h2>⚡ Built-in Actions</h2>
                    <p>Actions are the basic building blocks for creating bot logic. Each action performs a specific function.</p>
                    
                    <div class="actions-overview">
                        <div class="action-category">
                            <h3>📱 Core Actions</h3>
                            <ul>
                                <li><a href="actions/send-message.html">SendMessage</a> - Send messages with inline buttons</li>
                                <li><a href="actions/custom.html">CustomAction</a> - Universal action for custom logic</li>
                            </ul>
                        </div>
                        
                        <div class="action-category">
                            <h3>🧭 Navigation</h3>
                            <ul>
                                <li><a href="actions/navigate.html">Navigate</a> - Navigate to menu item</li>
                                <li><a href="actions/back.html">Back</a> - Return to previous menu</li>
                            </ul>
                        </div>
                        
                        <div class="action-category">
                            <h3>💬 Message Management</h3>
                            <ul>
                                <li><a href="actions/update-message.html">UpdateMessage</a> - Update message</li>
                                <li><a href="actions/delete-message.html">DeleteMessage</a> - Delete message</li>
                            </ul>
                        </div>
                        
                        <div class="action-category">
                            <h3>⌨️ Input Handling</h3>
                            <ul>
                                <li><a href="actions/request-input.html">RequestInput</a> - Request input from user</li>
                                <li><a href="actions/cancel-awaiting-input.html">CancelAwaitingInput</a> - Cancel input waiting</li>
                            </ul>
                        </div>
                        
                        <div class="action-category">
                            <h3>💾 Storage</h3>
                            <ul>
                                <li><a href="actions/store.html">Store</a> - Store data</li>
                            </ul>
                        </div>
                        
                        <div class="action-category">
                            <h3>🌐 API Integration</h3>
                            <ul>
                                <li><a href="actions/request-api.html">RequestApi</a> - HTTP requests to external APIs</li>
                            </ul>
                        </div>
                        
                        
                    </div>
                </section>

                <!-- Built-in Functions -->
                <section id="functions" class="section">
                    <h2>🔧 Built-in Functions</h2>
                    <p>Functions allow you to create complex data processing and calculation logic.</p>
                    
                    <div class="functions-overview">
                        <div class="function-category">
                            <h3>📝 String Functions</h3>
                            <ul>
                                <li><a href="functions/join-to-string.html">JoinToString</a> - Join array of values into string</li>
                            </ul>
                        </div>
                        
                        <div class="function-category">
                            <h3>🔢 Arithmetic Functions</h3>
                            <ul>
                                <li><a href="functions/plus.html">Plus</a> - Addition of numbers</li>
                                <li><a href="functions/minus.html">Minus</a> - Subtraction of numbers</li>
                                <li><a href="functions/multiply.html">Multiply</a> - Multiplication of numbers</li>
                                <li><a href="functions/divide.html">Divide</a> - Division of numbers</li>
                                <li><a href="functions/mod.html">Mod</a> - Modulo operation</li>
                            </ul>
                        </div>
                        
                        <div class="function-category">
                            <h3>🔍 Logical Functions</h3>
                            <ul>
                                <li><a href="functions/equals.html">Equals</a> - Compare values with conditional result</li>
                            </ul>
                        </div>
                        
                        <div class="function-category">
                            <h3>💾 Storage Functions</h3>
                            <ul>
                                <li><a href="functions/read-storage.html">ReadStorage</a> - Read data from storage</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- Interpolation -->
                <section id="interpolation" class="section">
                    <h2>🔗 Interpolation</h2>
                    <p>The new interpolation system provides a unified and intuitive way to access variables in scenarios, actions, and functions. It works similarly to variable scoping in programming languages.</p>

                    <h3>Available Contexts</h3>
                    <div class="context-grid">
                        <div class="context-card">
                            <h4>Environment Variables</h4>
                            <p>System environment variables</p>
                            <ul>
                                <li><code>{{env.API_URL}}</code> - API URL from environment</li>
                                <li><code>{{env.BOT_TOKEN}}</code> - Bot token from environment</li>
                            </ul>
                        </div>
                        <div class="context-card">
                            <h4>User Data</h4>
                            <p>Data from scenario's data block</p>
                            <ul>
                                <li><code>{{name}}</code> - Direct access to user data</li>
                                <li><code>{{email}}</code> - Direct access to user data</li>
                                <li><code>{{data.name}}</code> - Explicit data prefix</li>
                                <li><code>{{data.email}}</code> - Explicit data prefix</li>
                            </ul>
                        </div>
                        <div class="context-card">
                            <h4>Local Context</h4>
                            <p>Action and function local variables</p>
                            <ul>
                                <li><code>{{messageId}}</code> - Direct access to local variables</li>
                                <li><code>{{response.status}}</code> - API response status</li>
                                <li><code>{{response.url}}</code> - API response URL</li>
                                <li><code>{{local.messageId}}</code> - Explicit local prefix</li>
                            </ul>
                        </div>
                        <div class="context-card">
                            <h4>Function Parameters</h4>
                            <p>Function input parameters</p>
                            <ul>
                                <li><code>{{params.value}}</code> - Function parameter</li>
                                <li><code>{{params.separator}}</code> - Function parameter</li>
                            </ul>
                        </div>
                    </div>

                    <h3>Priority Order</h3>
                    <p>Variables are resolved in the following priority order:</p>
                    <ol>
                        <li><strong>Local Context</strong> - Action/function specific variables</li>
                        <li><strong>Function Parameters</strong> - Function input parameters</li>
                        <li><strong>User Data</strong> - Scenario data block</li>
                        <li><strong>Environment</strong> - System environment variables</li>
                    </ol>

                    <h3>Usage Examples</h3>
                    <pre><code class="language-json">{
  "action": "SendMessage",
  "text": "Hello, {{name}}! You are in menu {{currentMenu}}"
}</code></pre>

                    <pre><code class="language-json">{
  "action": "RequestApi",
  "url": "{{env.API_URL}}/users/{{userId}}",
  "headers": {
    "Authorization": "Bearer {{token}}"
  }
}</code></pre>

                    <h3>Function Examples</h3>
                    <pre><code class="language-json">{
  "function": "FormatUserInfo",
  "params": {
    "name": "{{name}}",
    "email": "{{email}}"
  }
}</code></pre>

                    <pre><code class="language-json">{
  "function": "JoinToString",
  "params": {
    "values": ["{{name}}", "{{email}}"],
    "separator": ", "
  }
}</code></pre>
                </section>

                <!-- Examples -->
                <section id="examples" class="section">
                    <h2>💡 Scenario Examples</h2>
                    <p>Practical examples of creating bots with various functionality.</p>
                    
                    <div class="example-category">
                        <h3>📋 Survey Bot</h3>
                        <p>Simple bot for collecting information from users</p>
                        <pre><code class="language-json">{
  "onStartActions": [
    {
      "action": "Navigate",
      "menuItem": "Welcome"
    }
  ],
  "menuItems": {
    "Welcome": {
      "onNavigation": {
        "action": "SendMessage",
        "text": "👋 Welcome to the survey!",
        "inlineActions": [
          {
            "title": "Start Survey",
            "onClick": {
              "action": "Navigate",
              "menuItem": "Question1"
            }
          }
        ]
      }
    },
    "Question1": {
      "onNavigation": {
        "action": "RequestInput",
        "key": "name",
        "hint": "What is your name?",
        "onDone": {
          "action": "Navigate",
          "menuItem": "Question2"
        },
        "onCancel": {
          "action": "Navigate",
          "menuItem": "Welcome"
        }
      }
    },
    "Question2": {
      "onNavigation": {
        "action": "RequestInput",
        "key": "age",
        "hint": "How old are you?",
        "onDone": {
          "action": "Navigate",
          "menuItem": "Results"
        }
      }
    },
    "Results": {
      "onNavigation": {
        "action": "SendMessage",
        "text": "Thank you for participating! Your answers:\nName: {{name}}\nAge: {{age}}",
        "inlineActions": [
          {
            "title": "Back to Start",
            "onClick": {
              "action": "Navigate",
              "menuItem": "Welcome"
            }
          }
        ]
      }
    }
  }
}</code></pre>
                    </div>

                    <div class="example-category">
                        <h3>🌐 Bot with API Integration</h3>
                        <p>Bot for getting data from external APIs</p>
                        <pre><code class="language-json">{
  "onStartActions": [
    {
      "action": "Navigate",
      "menuItem": "Main"
    }
  ],
  "menuItems": {
    "Main": {
      "onNavigation": {
        "action": "SendMessage",
        "text": "🌐 Bot with API Integration",
        "inlineActions": [
          {
            "title": "Get Weather",
            "onClick": {
              "action": "RequestApi",
              "method": "GET",
              "baseUrl": "https://api.openweathermap.org",
              "path": "/data/2.5/weather",
              "params": {
                "q": "Moscow",
                "appid": "YOUR_API_KEY",
                "units": "metric",
                "lang": "ru"
              },
              "onSuccess": {
                "action": "SendMessage",
                "text": "🌤️ Weather in Moscow:\nTemperature: {{response.body.main.temp}}°C\nDescription: {{response.body.weather.0.description}}"
              },
              "onFailure": {
                "action": "SendMessage",
                "text": "❌ Failed to get weather data"
              }
            }
          }
        ]
      }
    }
  }
}</code></pre>
                    </div>

                    <div class="example-category">
                        <h3>👤 User Profile Bot</h3>
                        <p>Bot with registration system and profile management</p>
                        <pre><code class="language-json">{
  "onStartActions": [
    {
      "action": "Navigate",
      "menuItem": "Main"
    }
  ],
  "menuItems": {
    "Main": {
      "onNavigation": {
        "action": "SendMessage",
        "text": {
          "function": "JoinToString",
          "values": [
            "👋 Hello, ",
            {
              "function": "ReadStorage",
              "key": "userName",
              "fallbackValue": "Guest"
            },
            "!"
          ]
        },
        "inlineActions": [
          {
            "title": "👤 Profile",
            "onClick": {
              "action": "Navigate",
              "menuItem": "Profile"
            }
          },
          {
            "title": "⚙️ Settings",
            "onClick": {
              "action": "Navigate",
              "menuItem": "Settings"
            }
          }
        ]
      }
    },
    "Profile": {
      "onNavigation": {
        "action": "SendMessage",
        "text": {
          "function": "JoinToString",
          "values": [
            "👤 Your profile:\n",
            "Name: ",
            {
              "function": "ReadStorage",
              "key": "userName",
              "fallbackValue": "Not specified"
            },
            "\nEmail: ",
            {
              "function": "ReadStorage",
              "key": "userEmail",
              "fallbackValue": "Not specified"
            },
            "\nPhone: ",
            {
              "function": "ReadStorage",
              "key": "userPhone",
              "fallbackValue": "Not specified"
            }
          ]
        },
        "inlineActions": [
          {
            "title": "✏️ Edit",
            "onClick": {
              "action": "Navigate",
              "menuItem": "EditProfile"
            }
          },
          {
            "title": "⬅️ Back",
            "onClick": {
              "action": "Back"
            }
          }
        ]
      }
    },
    "EditProfile": {
      "onNavigation": {
        "action": "RequestInput",
        "key": "newName",
        "hint": "Enter new name:",
        "onDone": {
          "action": "Store",
          "key": "userName",
          "value": "{{newName}}"
        },
        "onCancel": {
          "action": "Navigate",
          "menuItem": "Profile"
        }
      }
    }
  }
}</code></pre>
                    </div>

                    <div class="example-category">
                        <h3>🛒 Shopping Bot</h3>
                        <p>Simple bot for demonstrating shopping cart functionality</p>
                        <pre><code class="language-json">{
  "onStartActions": [
    {
      "action": "Navigate",
      "menuItem": "Catalog"
    }
  ],
  "menuItems": {
    "Catalog": {
      "onNavigation": {
        "action": "SendMessage",
        "text": "🛒 Product Catalog",
        "inlineActions": [
          {
            "title": "📱 Phones",
            "onClick": {
              "action": "Navigate",
              "menuItem": "Phones"
            }
          },
          {
            "title": "💻 Laptops",
            "onClick": {
              "action": "Navigate",
              "menuItem": "Laptops"
            }
          },
          {
            "title": "🛍️ Cart",
            "onClick": {
              "action": "Navigate",
              "menuItem": "Cart"
            }
          }
        ]
      }
    },
    "Phones": {
      "onNavigation": {
        "action": "SendMessage",
        "text": "📱 Phones:\n1. iPhone 15 - $800\n2. Samsung Galaxy S24 - $700\n3. Xiaomi 14 - $500",
        "inlineActions": [
          {
            "title": "Add iPhone",
            "onClick": {
              "action": "Store",
              "key": "cart",
              "value": {
                "function": "JoinToString",
                "values": [
                  {
                    "function": "ReadStorage",
                    "key": "cart",
                    "fallbackValue": ""
                  },
                  "iPhone 15 - $800\n"
                ]
              }
            }
          },
          {
            "title": "Add Samsung",
            "onClick": {
              "action": "Store",
              "key": "cart",
              "value": {
                "function": "JoinToString",
                "values": [
                  {
                    "function": "ReadStorage",
                    "key": "cart",
                    "fallbackValue": ""
                  },
                  "Samsung Galaxy S24 - $700\n"
                ]
              }
            }
          },
          {
            "title": "⬅️ Back",
            "onClick": {
              "action": "Back"
            }
          }
        ]
      }
    },
    "Laptops": {
      "onNavigation": {
        "action": "SendMessage",
        "text": "💻 Laptops:\n1. MacBook Pro M3 - $1500\n2. Dell XPS 13 - $1200\n3. Lenovo ThinkPad - $900",
        "inlineActions": [
          {
            "title": "Add MacBook",
            "onClick": {
              "action": "Store",
              "key": "cart",
              "value": {
                "function": "JoinToString",
                "values": [
                  {
                    "function": "ReadStorage",
                    "key": "cart",
                    "fallbackValue": ""
                  },
                  "MacBook Pro M3 - $1500\n"
                ]
              }
            }
          },
          {
            "title": "Add Dell",
            "onClick": {
              "action": "Store",
              "key": "cart",
              "value": {
                "function": "JoinToString",
                "values": [
                  {
                    "function": "ReadStorage",
                    "key": "cart",
                    "fallbackValue": ""
                  },
                  "Dell XPS 13 - $1200\n"
                ]
              }
            }
          },
          {
            "title": "⬅️ Back",
            "onClick": {
              "action": "Back"
            }
          }
        ]
      }
    },
    "Cart": {
      "onNavigation": {
        "action": "SendMessage",
        "text": {
          "function": "JoinToString",
          "values": [
            "🛍️ Your cart:\n\n",
            {
              "function": "ReadStorage",
              "key": "cart",
              "fallbackValue": "Cart is empty"
            },
            "\n\n💡 Use the buttons below to manage your cart"
          ]
        },
        "inlineActions": [
          {
            "title": "🗑️ Clear Cart",
            "onClick": {
              "action": "Store",
              "key": "cart",
              "value": ""
            }
          },
          {
            "title": "🔄 Refresh",
            "onClick": {
              "action": "Navigate",
              "menuItem": "Cart"
            }
          },
          {
            "title": "⬅️ Back",
            "onClick": {
              "action": "Back"
            }
          }
        ]
      }
    }
  }
}</code></pre>
                    </div>
                </section>

            </div>
        </main>
    </div>

    <script src="script.js"></script>
</body>
</html>
